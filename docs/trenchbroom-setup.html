<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>1.2. TrenchBroom setup - MESS 1.2.2 documentation</title>

    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="images/mess_icon.png"/>
  </head>

  <body>
    <div class="root-container">
      <nav>
        <h1><a class="home-link" href="index.html">MESS 1.2.2</a></h1>
        <ul>
          <li class="current-page">
<a class="current-page" href="index.html">1. Getting started</a>
<ul class="toc">
<li><a href="jack-&-hammer-setup.html">1.1. JACK & Hammer setup</a></li>
<li class="current-page"><a class="current-page" href="trenchbroom-setup.html">1.2. TrenchBroom setup</a></li>
</ul>
</li>
<li>
<a href="tutorials.html">2. Tutorials</a>
<ul class="toc">
<li><a href="covering-terrain-with-props.html">Covering terrain with props</a></li>
<li><a href="covering-terrain-advanced-template-selection.html">Covering terrain&colon; advanced template selection</a></li>
<li><a href="covering-terrain-optimization.html">Covering terrain&colon; optimization</a></li>
<li><a href="making-a-kill-counter-with-mtl_trigger_counter.html">Making a kill counter with mtl_trigger_counter</a></li>
<li><a href="creating-interactive-linked-groups-in-trenchbroom.html">Creating interactive linked groups in TrenchBroom</a></li>
</ul>
</li>
<li>
<a href="configuration.html">3. Configuration</a>
<ul class="toc">
<li><a href="configuration-files.html">3.1. Configuration files</a></li>
<li><a href="command-line-options.html">3.2. Command-line options</a></li>
</ul>
</li>
<li>
<a href="template-entities.html">4. Template entities</a>
<ul class="toc">
<li><a href="mtl_env_model.html">4.1. mtl_env_model</a></li>
<li><a href="mtl_trigger_area.html">4.2. mtl_trigger_area</a></li>
<li><a href="mtl_trigger_counter.html">4.3. mtl_trigger_counter</a></li>
<li><a href="mtl_trigger_periodic.html">4.4. mtl_trigger_periodic</a></li>
<li><a href="mtl_trigger_random.html">4.5. mtl_trigger_random</a></li>
<li><a href="mtl_trigger_sequence.html">4.6. mtl_trigger_sequence</a></li>
<li><a href="cs_trigger_roundstart.html">4.7. cs_trigger_roundstart</a></li>
</ul>
</li>
<li>
<a href="template-behaviors.html">5. Template behaviors</a>
<ul class="toc">
<li><a href="target-patterns.html">5.1. Target patterns</a></li>
<li><a href="multi_manager-expansion.html">5.2. multi_manager expansion</a></li>
<li><a href="env_sprite-angles-fix.html">5.3. env_sprite angles fix</a></li>
<li><a href="linked-group-ids.html">5.4. Linked group IDs</a></li>
<li><a href="scrolling-texture-speed.html">5.5. Scrolling texture speed</a></li>
</ul>
</li>
<li>
<a href="macro-entities.html">6. Macro entities</a>
<ul class="toc">
<li><a href="macro_insert.html">6.1. macro_insert</a></li>
<li><a href="macro_cover.html">6.2. macro_cover</a></li>
<li><a href="macro_fill.html">6.3. macro_fill</a></li>
<li><a href="macro_brush.html">6.4. macro_brush</a></li>
<li><a href="macro_template.html">6.5. macro_template</a></li>
<li><a href="macro_remove_if.html">6.6. macro_remove_if</a></li>
</ul>
</li>
<li>
<a href="scripting.html">7. Scripting</a>
<ul class="toc">
<li><a href="entity-properties.html">7.1. Entity properties</a></li>
<li><a href="data-types.html">7.2. Data types</a></li>
<li><a href="operators.html">7.3. Operators</a></li>
<li><a href="standard-functions.html">7.4. Standard functions</a></li>
<li><a href="template-functions.html">7.5. Template functions</a></li>
<li><a href="rewrite-rules.html">7.6. Rewrite rules</a></li>
</ul>
</li>

        </ul>
      </nav>

      <div class="main-container">
        <main>
          <article>
            <h1 id="trenchbroom-setup">1.2. TrenchBroom setup</h1>
<p>
The following steps will help you to set up MESS for <a href="https://trenchbroom.github.io/">TrenchBroom</a>:</p>
<ul>
<li>
<a href="#downloading-mess">1.2.1. Downloading MESS</a></li>
<li>
<a href="#adding-the-mess-fgd-game-data-file">1.2.2. Adding the mess.fgd game data file</a></li>
<li>
<a href="#adding-the-mess-exe-compile-step">1.2.3. Adding the MESS.exe compile step</a></li>
</ul>
<h2 id="downloading-mess">1.2.1. Downloading MESS</h2>
<p>
This guide assumes that you have <a href="https://github.com/pwitvoet/mess/releases/tag/1.2.2">downloaded MESS 1.2.2</a> and extracted the contents of the zip file to <code>C:\HL\Tools\MESS\</code>. You should see the following files:</p>
<p>
<figure>
<img src="images/mess_folder_contents.png" alt="MESS folder contents" title="MESS folder contents">
<figcaption>MESS folder contents</figcaption>
</figure>
</p>
<h2 id="adding-the-mess-fgd-game-data-file">1.2.2. Adding the <code>mess.fgd</code> game data file</h2>
<p>
Even though a game configuration in TrenchBroom can contain multiple fgd files, only one can be active at the same time. This can be solved by creating a single 'master' fgd file that includes all the other fgds:</p>
<ol>
<li>
Go to the <code>games\Halflife</code> folder in your TrenchBroom installation folder.</li>
<li>
Copy <code>C:\HL\Tools\MESS\mess.fgd</code> into this folder.</li>
<li>
Create a text file named <code>HalfLife_main.fgd</code> (or whatever name you prefer) and add the following lines: <code>@include "HalfLife.fgd"</code> and <code>@include "mess.fgd"</code>. If you're using the latest ZHLT or VHLT compile tools, then you should also include <code>zhlt.fgd</code> here.</li>
<li>
Open <code>GameConfig.cfg</code> in a plain text editor, go to the <code>entities</code> section and replace the <code>"definitions": [ "HalfLife.fgd" ],</code> line with <code>"definitions": [ "HalfLife_main.fgd" ],</code>.</li>
<li>
Finally, open <code>C:\HL\Tools\MESS\mess.config</code> and change the line <code>fgd-path:   {EXE_DIR}\mess.fgd</code> so it points to the <code>mess.fgd</code> file in your TrenchBroom's <code>games\Halflife</code> folder. For example, if you installed TrenchBroom in <code>C:\HL\Tools\TrenchBroom</code>, then the line should be changed to <code>fgd-path:   C:\HL\Tools\TrenchBroom\games\Halflife\mess.fgd</code>.</li>
</ol>
<p>
Your TrenchBroom's <code>games\Halflife</code> folder should now contain at least the following files:</p>
<p>
<figure>
<img src="images/trenchbroom_games_halflife_folder.png" alt="TrenchBroom games Halflife folder" title="TrenchBroom games Halflife folder">
<figcaption>TrenchBroom games Halflife folder</figcaption>
</figure>
</p>
<p>
<code>HalfLife_main.fgd</code> should contain at least the following lines:</p>
<p>
<figure>
<img src="images/trenchbroom_halflife_main_fgd.png" alt="TrenchBroom HalfLife_main.fgd" title="TrenchBroom HalfLife_main.fgd">
<figcaption>TrenchBroom HalfLife_main.fgd</figcaption>
</figure>
</p>
<p>
And <code>mess.config</code>'s <code>fgd-path</code> setting should look like this (depending on where you installed TrenchBroom):</p>
<p>
<figure>
<img src="images/trenchbroom_mess_config_fgd_path.png" alt="TrenchBroom MESS fgd path" title="TrenchBroom MESS fgd path">
<figcaption>TrenchBroom MESS fgd path</figcaption>
</figure>
</p>
<h2 id="adding-the-mess-exe-compile-step">1.2.3. Adding the <code>MESS.exe</code> compile step</h2>
<ol>
<li>
Open or create a map in TrenchBroom, then go to the <code>Run</code> menu and select <code>Compile Map...</code>.</li>
<li>
If you already have a compilation profile for Half-Life, continue with step 3. Else, you'll need to create one by pressing the small <code>+</code> button on the left. Change the name of the new profile to something like <code>Half-Life</code>, then add the following tasks:<ol>
<li>
An <code>Export Map</code> task with the following file path: <code>${WORK_DIR_PATH}/${MAP_BASE_NAME}-compile.map</code> (the <code>-compile</code> part is important, because otherwise the source map file would be overwritten!).</li>
<li>
A <code>Run Tool</code> task. For the Tool Path, go to your compile tools folder and select <code>hlcsg_x64.exe</code> (or <code>hlcsg.exe</code>). In the Parameters field, enter <code>"${WORK_DIR_PATH}/${MAP_BASE_NAME}-compile.map"</code>. You can also add additional CSG parameters here.</li>
<li>
A second <code>Run Tool</code> task for <code>hlbsp_x64.exe</code>, with the same path in its Parameters field as the CSG task.</li>
<li>
A third <code>Run Tool</code> task for <code>hlvis_x64.exe</code>, again with the same path in its Parameters field as in the previous tasks.</li>
<li>
A final <code>Run Tool</code> task for <code>hlrad_x64.exe</code>, using the same path in its Parameters field as in the previous tasks.</li>
<li>
A <code>Rename File</code> task that copies <code>${WORK_DIR_PATH}/${MAP_BASE_NAME}-compile.bsp</code> to <code>${GAME_DIR_PATH}/${MODS[-1]}/maps/${MAP_BASE_NAME}.bsp</code>.</li>
</ol>
</li>
<li>
Add a new <code>Run Tool</code> task, and move it up to just before the CSG task.</li>
<li>
For the Tool Path, select <code>C:\HL\Tools\MESS\MESS.exe</code>.</li>
<li>
For the Parameters, enter <code>"${WORK_DIR_PATH}/${MAP_BASE_NAME}-compile.map"</code>.</li>
</ol>
<p>
The Compile window should now look like this:</p>
<p>
<figure>
<img src="images/trenchbroom_compile_map.png" alt="TrenchBroom Compile window" title="TrenchBroom Compile window">
<figcaption>TrenchBroom Compile window</figcaption>
</figure>
</p>
<p>
That's it! You're now ready to start using <a href="template-entities.html">template entities</a> and <a href="macro_template.html">templates</a>.</p>

          </article>
        </main>

        <footer>
          Â© copyright 2023, Pieter Witvoet
        </footer>
      </div>
    </div>
  </body>
</html>